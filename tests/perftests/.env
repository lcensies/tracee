POMETHEUS_ADDR=http://localhost:9090
WEBHOOK_ADDR=http://192.168.81.1:3434

EVENTS_LOST_STATS_FILE=${EVENTS_LOST_STATS_FILE:-/tmp/tracee/events_lost_metrics.json}
EVENTS_TOTAL_STATS_FILE=${EVENTS_TOTAL_STATS_FILE:-/tmp/tracee/events_total_metrics.json}
EVENTS_STATS_FILE=${EVENTS_STATS_FILE:-/tmp/tracee/events_metrics.json}
FILE_IO_STATS_FILE=${FILE_IO_STATS_FILE:-/tmp/tracee/file_io_metrics.json}
TRACEE_MEMORY_STATS_FILE=${TRACEE_MEMORY_STATS_FILE:-/tmp/tracee/agent_memory_metrics.json}

TEST_TYPE=pgbench
TEST_DURATION=60

DOCKER_INTERACTIVE_FLAG=-it
DOCKER_TRACEE_IMAGE=tracee:events_merging_disabled
# DOCKER_IMAGE=aquasec/tracee:latest

TRACEE_CPU_LIMIT=${TRACEE_CPU_LIMIT:-"0.1"}
TRACEE_NO_CONTAINER=false
TRACEE_ROOT=$(git rev-parse --show-toplevel)
TRACEE_CACHE_TYPE="${TRACEE_CACHE_TYPE:-mem}"
TRACEE_CACHE_STAGE="after-decode"
TRACEE_MEM_CACHE_SIZE=${TRACEE_MEM_CACHE_SIZE:-512}
# TRACEE_MEM_CACHE_SIZE=${TRACEE_MEM_CACHE_SIZE:-512}
TRACEE_DISK_CACHE_SIZE=${TRACEE_DISK_CACHE_SIZE:-16384}
TRACEE_PERF_BUFFER_SIZE=${TRACEE_PERF_BUFFER_SIZE:-1024}
TRACEE_LISTEN_ADDR=http:/localhost:3366
TRACEE_EVENTS_SINK_TIMEOUT=${TRACEE_EVENTS_SINK_TIMEOUT:-5}
TRACEE_BENCH_CMD="go run $TRACEE_ROOT/cmd/tracee-bench/main.go --single=true --output json"
TRACEE_BENCHMARK_OUTPUT_FILE=${TRACEE_BENCHMARK_OUTPUT_FILE:-""}
TRACEE_EXE=/tracee/tracee
# TRACEE_EVENTS=security_file_open
# --output [webhook|forward]:[protocol://user:pass@]host:port[?k=v#f]
# --output out-file:/tmp/tracee/tracee.log -
TRACEE_EVENTS=vfs_read,vfs_readv,vfs_write,creat,chmod,fchmod,chown,fchown,lchown,ptrace,setuid,setgid,setpgid,setsid,setreuid,setregid,setresuid,setresgid,setfsuid,setfsgid,init_module,fchownat,fchmodat,setns,process_vm_readv,process_vm_writev,finit_module,memfd_create,move_mount,sched_process_exec,security_inode_unlink,security_socket_connect,security_socket_accept,security_socket_bind,security_sb_mount,net_packet_icmp,net_packet_icmpv6,net_packet_dns_request,net_packet_dns_response,net_packet_http_request,net_packet_http_response
TRACEE_CACHE_FLAGS="--cache cache-stage=${TRACEE_CACHE_STAGE} --cache cache-type=${TRACEE_CACHE_TYPE} --cache mem-cache-size=${TRACEE_MEM_CACHE_SIZE}"

# TRACEE_OUTPUT_FILE="/tmp/tracee/output.json"
# TRACEE_OUTPUT_FLAGS="--output json --output out-file:${TRACEE_OUTPUT_FILE}"
# TRACEE_OUTPUT_FLAGS="--output none"
TRACEE_OUTPUT_FLAGS="--output webhook:${WEBHOOK_ADDR}"

# host: port: 3434

# --output [webho3k|forward]:[protocol://user:pass@]host:port[?k=v#f]

TRACEE_LOG_FILE=${TRACEE_LOG_FILE:-/tmp/tracee/tracee.log}
TRACEE_LOG_FLAGS="--log debug --log file:${TRACEE_LOG_FILE}"

TRACEE_FLAGS="${TRACEE_LOG_FLAGS} ${TRACEE_OUTPUT_FLAGS} ${TRACEE_CACHE_FLAGS} --metrics --healthz=true  -e ${TRACEE_EVENTS}"
# TRACEE_FLAGS="--config /etc/tracee/config.yaml"

TRACEE_CMD="docker run --cpus ${TRACEE_CPU_LIMIT} --name tracee -e TRACEE_EXE=${TRACEE_EXE} ${DOCKER_INTERACTIVE_FLAG} --rm --pid=host --cgroupns=host --privileged -v /etc/os-release:/etc/os-release-host:ro -v /boot:/boot -v /var/run:/var/run:ro -v /tmp/tracee:/tmp/tracee -v ${SCRIPT_DIR}/tracee:/etc/tracee -p 3366:3366 ${DOCKER_TRACEE_IMAGE}"
